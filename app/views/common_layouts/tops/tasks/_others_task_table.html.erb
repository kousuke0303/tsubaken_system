<div class="table-responsive">
  <table class="table table-bordered table-column-type">
    <tr>
      <th>期限</th>
      <th>タイトル</th>
      <th>内容</th>
      <th>その他事項</th>
      <th>担当者</th>
      <th>タスク作成日</th>
      <th>ステータス</th>
    </tr>
    <% tasks.each do |task| %>
    <tr>
      <td></td>
      <td><%= task.title %></td>
      <td><%= task.content %></td>
      <td><% %></td>
      <td><%= task.member_code.member_name_from_member_code %></td>
      <td><%= task.created_at_disp %></td>
      <td id="<%= task.id %>">
        <%= form_with model: task, url: "#", remote: true do |f| %>
          <%= f.select :status, {'未着手': 1, '着手中': 2, '完了': 3}, {selected: task.status_before_type_cast}, {class: "form-control",  id: "select_#{task.id}"} %>
        <% end %>
      </td>
    </tr>
    <% end %>
  </table>
</div>

<script>
  <% tasks.each do |task| %>
    $('#select_<%= task.id %>').on('change', function(){
      var id = <%= task.id %>
      var status = $(this).val();
      $.ajax({
        type: 'patch',
        url: "<%= change_status_employees_task_path(task) %>",
        data: { id: id, status: status }
      });
    });
  <% end %>
</script>